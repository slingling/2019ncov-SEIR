# 2019ncov-SEIR
 武汉肺炎SEIR模型模拟
武汉新型冠状病毒建模&预测（SEIR）

数据来源：卫健委

附：新型肺炎疫情跟踪石墨文档 https://shimo.im/sheets/tyWrrrqppYVwQtCW/gVSL1
# SEIR模型:
S（Susceptible）：易感者  
I（Infectious）：已被感染者  
R（Removed = recovered + dead）：因治愈或死亡而不再参与感染和被感染过程的人  
E（Exposed）：处于潜伏期的感染者，在潜伏期后以一定概率被确诊  
N（Population）：常驻人口数量  
β：疾病的有效接触率  
γ：平均恢复率：I -> R 的转换率，1/γ 表示被感染者从确诊被感染到康复或者死亡的平均日期  
βI：S -> I 的转换率  
Baseline:

参数估计与假设：

γ = 1/14，新型肺炎从确诊到康复或死亡的日期约为14天  
S = N = 11000000，武汉常驻人口大约11000000，初始时全部人口统一归为易感人群  
潜伏期 T = 10，潜伏期7天+确诊所需时间3天  
感染者每天密切接触的人数 K = 5    

模型修正：    
考虑潜伏期也具有传染性 传染率与确诊患者相同    
考虑潜伏期由于未发病，患者每日接触人员数目为确诊患者的两倍  
2019-12-08 为首例确诊病例出现日期. 

# 没有政府干预的情况

γ = 1/14，新型肺炎从确诊到康复或死亡的日期约为14天  
S = N = 11000000，武汉常驻人口大约11000000，初始时全部人口统一归为易感人群  
潜伏期 T = 10，潜伏期7天+确诊所需时间3天  
感染者每天接触的人数 K = 5  
潜伏者每天接触的人数 = 2*K = 10  
武汉当前死亡率0.04  
估计的传染率: 0.04   
估计的 R0(基本再生数): 3.1  

预计最大感染人数  4532735
预计累计感染人数  10997637
预计死亡人数  439892
![不采取措施](https://github.com/slingling/2019ncov-SEIR/blob/master/results/origin-%E6%AD%A6%E6%B1%89.png?raw=true)
# CASE1: 2020.1.23日之后武汉封城

γ = 1/14，新型肺炎从确诊到康复或死亡的日期约为14天
N = 9000000，武汉封城之后留驻居民约为9000000
潜伏期 T = 8，潜伏期7天+确诊所需时间1天(确诊时间加快)
感染者每天接触的人数 K = 1
潜伏者每天接触的人数 = 2*K = 2
武汉当前死亡率0.04，治愈率0.05
1月23日已有累计确诊380例：I0 = 380，正在接受观察的密切接触者1693人，E0 = 1693，治愈28例，死亡17例：R0 = 28+17 = 45
case1 = Estimate_Wuhan_Outbreak(Est, k =1,ke = 2, N=9000000,
                E0 = 1693, I0 = 380, R0 = 45, T=8, econ = 450)
result1 = case1._run_SIER('Forecat 2019-nCoV Outbreak in Wuhan after 2020-01-23 using offical number',
        'Wuhan Population','Days after 2020-01-23', death_rate = 0.04, show_Sus = False)
估计的传染率: 0.04 
估计的 R0(基本再生数): 3.1

预计最大感染人数  311558
预计累计感染人数  4040249
预计死亡人数  159644
![case1](https://github.com/slingling/2019ncov-SEIR/blob/master/results/case1.png?raw=true)
# CASE2: 2020.2.1日起（1.23 T天后）政府实施严格控制

感染者确诊之后将被严格监控隔离，每天接触的人数 K = 0
潜伏者每天接触的人数仍为2
武汉当前死亡率0.04，治愈率0.05
2月1日已有累计确诊3215例：I0 = 3215，正在接受观察的密切接触者16557人，E0 = 16557，治愈139例，死亡192例：R0 = 331
case2 = Estimate_Wuhan_Outbreak(Est, k =0, ke = 2,N=9000000,
                E0 = 16557, I0 = 3215, R0 = 331, T=8, econ = 150)
result2 = case2._run_SIER('Forecat 2019-nCoV Outbreak in Wuhan after 2020-02-01 using offical number',
        'Wuhan Population','Days after 2020-02-01', death_rate = 0.04, show_Sus = False)
估计的传染率: 0.04 
估计的 R0(基本再生数): 3.1

预计最大感染人数  15693
预计累计感染人数  57421
预计死亡人数  2428
![case2](https://github.com/slingling/2019ncov-SEIR/blob/master/results/case2.png?raw=true)
结论： 在政府严格管控下，武汉疫情有望在2.18日左右达到峰值

# CASE3:根据交通数据模拟全国范围内的传播走向

迁移数据：武汉迁出，迁入强度，武汉迁出到各个省份的占比，各个省份人员迁入武汉的占比。
数据来自：百度慧眼

时间跨度：2020.01.01-2020.01.25
考虑的等级为省级，每一天人员动态移动，以武汉作为传播起点，假设当前武汉有感染人数20人
具体步骤

每一步，所有人员以一定概率进行选择全局出行（省间出行，只考虑与武汉的交互），局部出行（省内出行）
计算人员的转移情况（由于计算所有人员的活动较为复杂，并且已知只有感染者和潜伏者对实验结果密切相关，故只按照迁移比例计算这两种人的转移）
计算接触感染情况
每一步转移和感染之后统计每个省的人员感染情况
1.25日之后默认为城市封闭，均为省内传播
![case3](https://github.com/slingling/2019ncov-SEIR/blob/master/results/case3.png?raw=true)
